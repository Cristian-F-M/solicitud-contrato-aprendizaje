const buttonSearchEmails=document.getElementById("button-search-emails");let iMoreOptions=document.querySelectorAll('[data-name="more-options"]');const aBlacklist=document.querySelectorAll('[data-name="more-options"] + .container-more-options ul li a'),mainSearchEmails=document.querySelector(".main-search-emails"),tbodyTableCompanies=document.getElementById("tbody-table-companies"),containerTableCompanies=document.querySelector(".container-table-companies"),containerInformationSearch=document.querySelector(".container-information-search"),containerMessage=document.querySelector(".container-message"),lastUpdate=document.getElementById("lastUpdate"),cantCompanies=document.getElementById("cantCompanies");var searching=!1;async function searchEmails(){const e=await fetch("/Company/Search-Emails",{method:"POST"});return await e.json()}function closeMoreOptions(){iMoreOptions=document.querySelectorAll('[data-name="more-options"]'),document.addEventListener("click",(e=>{let t=e.target;iMoreOptions.forEach((e=>{let n=e.nextElementSibling,o=e.querySelector("svg");t!=e&&t!=n&&t!=o&&n.classList.remove("show")}))}))}function createTrTableCompanies(e){const{company_id:t,company_name:n,company_email_address:o,company_departament:a,company_city:s,blacklisted:i}=e;let c={add:`/company/add/${t}`,remove:`/company/remove/${t}`},l=document.createElement("tr"),r=document.createElement("td"),m=document.createElement("td"),d=document.createElement("td"),p=document.createElement("td"),h=document.createElement("i"),u=document.createElement("div"),E=document.createElement("ul"),g=document.createElement("li"),b=document.createElement("a");return h.classList.add("bi","bi-list"),h.setAttribute("title","More options"),h.setAttribute("data-name","more-options"),h.addEventListener("click",(()=>{h.nextElementSibling.classList.toggle("show")})),u.classList.add("container-more-options"),m.classList.add("text-18"),b.setAttribute("href",i?c.remove:c.add),b.textContent=i?"Remove to blacklist":"Add to blacklist",u.appendChild(E),E.appendChild(g),g.appendChild(b),p.appendChild(h),p.appendChild(u),r.textContent=n,m.textContent=o,d.textContent=`${a} / ${s}`,l.appendChild(r),l.appendChild(m),l.appendChild(d),l.appendChild(p),l}aBlacklist.forEach((e=>{e.addEventListener("click",(()=>{sessionStorage.setItem("scrollPosition",mainSearchEmails.scrollTop),console.log(mainSearchEmails.scrollTop)}))})),window.onload=function(){var e=sessionStorage.getItem("scrollPosition");e&&setTimeout((function(){mainSearchEmails.scrollTo({top:e,behavior:"smooth"}),sessionStorage.removeItem("scrollPosition")}),100)},buttonSearchEmails.addEventListener("click",(async()=>{if(searching)return;showInformation(),showFullLoading(),setTimeout((()=>{closeInformation()}),5e3),searching=!0,buttonSearchEmails.disabled=!0,data=await searchEmails();const{information:e,companies:t}=data;tbodyTableCompanies.innerHTML="",t.forEach((e=>{const t=createTrTableCompanies(e);tbodyTableCompanies.appendChild(t)})),lastUpdate.innerText=e.lastUpdated,cantCompanies.innerText=e.cantCompanies,closeMoreOptions(),containerTableCompanies.classList.contains("show")||containerTableCompanies.classList.toggle("show"),containerInformationSearch.classList.contains("show")||containerInformationSearch.classList.toggle("show"),containerMessage.classList.contains("show")&&containerMessage.classList.toggle("show"),buttonSearchEmails.disabled=!1,searching=!1,hideFullLoading(),showSearchCompleted()})),iMoreOptions.forEach((e=>{e.addEventListener("click",(()=>{e.nextElementSibling.classList.toggle("show")}))})),closeMoreOptions();